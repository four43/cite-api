//Copyright 2012, etc.

/**
 * almond 0.1.2 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){typeof define=="function"&&define.amd?define(["handlebars"],t):e.citeApi=t(e.$,e._)})(this,function(e,t){var n,r,i;return function(e){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h,p,d,v;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(p=0;v=e[p];p++)if(v===".")e.splice(p,1),p-=1;else if(v===".."){if(p===1&&(e[2]===".."||e[0]===".."))return!0;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(p=s.length;p>0;p-=1){u=s.slice(0,p).join("/");if(n)for(d=n.length;d>0;d-=1){a=r[n.slice(0,d).join("/")];if(a){a=a[u];if(a){f=a,l=p;break}}}if(f)break;!c&&i&&i[u]&&(c=i[u],h=p)}!f&&c&&(f=c,l=h),f&&(s.splice(0,l,f),e=s.join("/"))}return e}function h(t,n){return function(){return l.apply(e,a.call(arguments,0).concat([t,n]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(n){t[e]=n}}function v(n){if(s.hasOwnProperty(n)){var r=s[n];delete s[n],u[n]=!0,f.apply(e,r)}if(!t.hasOwnProperty(n))throw new Error("No "+n);return t[n]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var t={},s={},o={},u={},a=[].slice,f,l;f=function(n,r,i,o){var a=[],f,l,c,p,y,b;o=o||n;if(typeof i=="function"){r=!r.length&&i.length?["require","exports","module"]:r;for(b=0;b<r.length;b++){y=m(r[b],o),c=y.f;if(c==="require")a[b]=h(n);else if(c==="exports")a[b]=t[n]={},f=!0;else if(c==="module")l=a[b]={id:n,uri:"",exports:t[n],config:g(n)};else if(t.hasOwnProperty(c)||s.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=t[c];else if(!u[c])throw new Error(n+" missing "+c)}p=i.apply(t[n],a);if(n)if(l&&l.exports!==e&&l.exports!==t[n])t[n]=l.exports;else if(p!==e||!f)t[n]=p}else n&&(t[n]=i)},n=r=l=function(t,n,r,i){return typeof t=="string"?v(m(t,n).f):(t.splice||(o=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},i?f(e,t,n,r):setTimeout(function(){f(e,t,n,r)},15),l)},l.config=function(e){return o=e,l},i=function(e,t,n){t.splice||(n=t,t=[]),s[e]=[e,t,n]},i.amd={jQuery:!0}}(),i("../tools/almond",function(){}),i("lodash/internal/arrayEach",[],function(){function e(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e)===!1)break;return e}return e}),i("lodash/lang/isObject",[],function(){function e(e){var t=typeof e;return t=="function"||e&&t=="object"||!1}return e}),i("lodash/internal/toObject",["../lang/isObject"],function(e){function t(t){return e(t)?t:Object(t)}return t}),i("lodash/internal/baseFor",["./toObject"],function(e){function t(t,n,r){var i=-1,s=e(t),o=r(t),u=o.length;while(++i<u){var a=o[i];if(n(s[a],a,s)===!1)break}return t}return t}),i("lodash/internal/isLength",[],function(){function t(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=e}var e=Math.pow(2,53)-1;return t}),i("lodash/internal/baseToString",[],function(){function e(e){return typeof e=="string"?e:e==null?"":e+""}return e}),i("lodash/string/escapeRegExp",["../internal/baseToString"],function(e){function r(r){return r=e(r),r&&n.test(r)?r.replace(t,"\\$&"):r}var t=/[.*+?^${}()|[\]\/\\]/g,n=RegExp(t.source);return r}),i("lodash/internal/isObjectLike",[],function(){function e(e){return e&&typeof e=="object"||!1}return e}),i("lodash/lang/isNative",["../string/escapeRegExp","../internal/isObjectLike"],function(e,t){function a(e){return e==null?!1:o.call(e)==n?u.test(s.call(e)):t(e)&&r.test(e)||!1}var n="[object Function]",r=/^\[object .+?Constructor\]$/,i=Object.prototype,s=Function.prototype.toString,o=i.toString,u=RegExp("^"+e(o).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return a}),i("lodash/lang/isArguments",["../internal/isLength","../internal/isObjectLike"],function(e,t){function o(i){var o=t(i)?i.length:n;return e(o)&&s.call(i)==r||!1}var n,r="[object Arguments]",i=Object.prototype,s=i.toString;return o}),i("lodash/lang/isArray",["../internal/isLength","./isNative","../internal/isObjectLike"],function(e,t,n){var r="[object Array]",i=Object.prototype,s=i.toString,o=t(o=Array.isArray)&&o,u=o||function(t){return n(t)&&e(t.length)&&s.call(t)==r||!1};return u}),i("lodash/internal/isIndex",[],function(){function t(t,n){return t=+t,n=n==null?e:n,t>-1&&t%1==0&&t<n}var e=Math.pow(2,53)-1;return t}),i("lodash/internal/root",[],function(){var e={"function":!0,object:!0},t=e[typeof window]&&window!==(this&&this.window)?window:this,n=e[typeof exports]&&exports&&!exports.nodeType&&exports,r=e[typeof module]&&module&&!module.nodeType&&module,i=n&&r&&typeof global=="object"&&global;return i&&(i.global===i||i.window===i||i.self===i)&&(t=i),t}),i("lodash/support",["./lang/isNative","./internal/root"],function(e,t){var n=/\bthis\b/,r=Object.prototype,i=(i=t.window)&&i.document,s=r.propertyIsEnumerable,o={};return function(r){o.funcDecomp=!e(t.WinRTError)&&n.test(function(){return this}),o.funcNames=typeof Function.name=="string";try{o.dom=i.createDocumentFragment().nodeType===11}catch(u){o.dom=!1}try{o.nonEnumArgs=!s.call(arguments,1)}catch(u){o.nonEnumArgs=!0}}(0,0),o}),i("lodash/object/keysIn",["../lang/isArguments","../lang/isArray","../internal/isIndex","../internal/isLength","../lang/isObject","../support"],function(e,t,n,r,i,s){function a(o){if(o==null)return[];i(o)||(o=Object(o));var a=o.length;a=a&&r(a)&&(t(o)||s.nonEnumArgs&&e(o))&&a||0;var f=o.constructor,l=-1,c=typeof f=="function"&&f.prototype===o,h=Array(a),p=a>0;while(++l<a)h[l]=l+"";for(var d in o)(!p||!n(d,a))&&(d!="constructor"||!c&&!!u.call(o,d))&&h.push(d);return h}var o=Object.prototype,u=o.hasOwnProperty;return a}),i("lodash/internal/shimKeys",["../lang/isArguments","../lang/isArray","./isIndex","./isLength","../object/keysIn","../support"],function(e,t,n,r,i,s){function a(o){var a=i(o),f=a.length,l=f&&o.length,c=l&&r(l)&&(t(o)||s.nonEnumArgs&&e(o)),h=-1,p=[];while(++h<f){var d=a[h];(c&&n(d,l)||u.call(o,d))&&p.push(d)}return p}var o=Object.prototype,u=o.hasOwnProperty;return a}),i("lodash/object/keys",["../internal/isLength","../lang/isNative","../lang/isObject","../internal/shimKeys"],function(e,t,n,r){var i=t(i=Object.keys)&&i,s=i?function(t){if(t)var s=t.constructor,o=t.length;return typeof s=="function"&&s.prototype===t||typeof t!="function"&&o&&e(o)?r(t):n(t)?i(t):[]}:r;return s}),i("lodash/internal/baseForOwn",["./baseFor","../object/keys"],function(e,t){function n(n,r){return e(n,r,t)}return n}),i("lodash/internal/arrayCopy",[],function(){function e(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r)t[n]=e[n];return t}return e}),i("lodash/internal/baseForIn",["./baseFor","../object/keysIn"],function(e,t){function n(n,r){return e(n,r,t)}return n}),i("lodash/internal/shimIsPlainObject",["./baseForIn","./isObjectLike"],function(e,t){function o(r){var o;if(!t(r)||s.call(r)!=n||!i.call(r,"constructor")&&(o=r.constructor,typeof o=="function"&&!(o instanceof o)))return!1;var u;return e(r,function(e,t){u=t}),typeof u=="undefined"||i.call(r,u)}var n="[object Object]",r=Object.prototype,i=r.hasOwnProperty,s=r.toString;return o}),i("lodash/lang/isPlainObject",["./isNative","../internal/shimIsPlainObject"],function(e,t){var n="[object Object]",r=Object.prototype,i=r.toString,s=e(s=Object.getPrototypeOf)&&s,o=s?function(r){if(!r||i.call(r)!=n)return!1;var o=r.valueOf,u=e(o)&&(u=s(o))&&s(u);return u?r==u||s(r)==u:t(r)}:t;return o}),i("lodash/lang/isTypedArray",["../internal/isLength","../internal/isObjectLike"],function(e,t){function L(n){return t(n)&&e(n.length)&&N[k.call(n)]||!1}var n="[object Arguments]",r="[object Array]",i="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",a="[object Map]",f="[object Number]",l="[object Object]",c="[object RegExp]",h="[object Set]",p="[object String]",d="[object WeakMap]",v="[object ArrayBuffer]",m="[object Float32Array]",g="[object Float64Array]",y="[object Int8Array]",b="[object Int16Array]",w="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",x="[object Uint16Array]",T="[object Uint32Array]",N={};N[m]=N[g]=N[y]=N[b]=N[w]=N[E]=N[S]=N[x]=N[T]=!0,N[n]=N[r]=N[v]=N[i]=N[s]=N[o]=N[u]=N[a]=N[f]=N[l]=N[c]=N[h]=N[p]=N[d]=!1;var C=Object.prototype,k=C.toString;return L}),i("lodash/internal/baseCopy",[],function(){function e(e,t,n){n||(n=t,t={});var r=-1,i=n.length;while(++r<i){var s=n[r];t[s]=e[s]}return t}return e}),i("lodash/lang/toPlainObject",["../internal/baseCopy","../object/keysIn"],function(e,t){function n(n){return e(n,t(n))}return n}),i("lodash/internal/baseMergeDeep",["./arrayCopy","../lang/isArguments","../lang/isArray","./isLength","../lang/isPlainObject","../lang/isTypedArray","../lang/toPlainObject"],function(e,t,n,r,i,s,o){function a(a,f,l,c,h,p,d){var v=p.length,m=f[l];while(v--)if(p[v]==m){a[l]=d[v];return}var g=a[l],y=h?h(g,m,l,a,f):u,b=typeof y=="undefined";b&&(y=m,r(m.length)&&(n(m)||s(m))?y=n(g)?g:g?e(g):[]:i(m)||t(m)?y=t(g)?o(g):i(g)?g:{}:b=!1),p.push(m),d.push(y);if(b)a[l]=c(y,m,h,p,d);else if(y===y?y!==g:g===g)a[l]=y}var u;return a}),i("lodash/internal/baseMerge",["./arrayEach","./baseForOwn","./baseMergeDeep","../lang/isArray","./isLength","../lang/isObject","./isObjectLike","../lang/isTypedArray"],function(e,t,n,r,i,s,o,u){function f(l,c,h,p,d){if(!s(l))return l;var v=i(c.length)&&(r(c)||u(c));return(v?e:t)(c,function(e,t,r){if(o(e))return p||(p=[]),d||(d=[]),n(l,r,t,f,h,p,d);var i=l[t],s=h?h(i,e,t,l,r):a,u=typeof s=="undefined";u&&(s=e),(v||typeof s!="undefined")&&(u||(s===s?s!==i:i===i))&&(l[t]=s)}),l}var a;return f}),i("lodash/utility/identity",[],function(){function e(e){return e}return e}),i("lodash/internal/bindCallback",["../utility/identity"],function(e){function t(t,n,r){if(typeof t!="function")return e;if(typeof n=="undefined")return t;switch(r){case 1:return function(e){return t.call(n,e)};case 3:return function(e,r,i){return t.call(n,e,r,i)};case 4:return function(e,r,i,s){return t.call(n,e,r,i,s)};case 5:return function(e,r,i,s,o){return t.call(n,e,r,i,s,o)}}return function(){return t.apply(n,arguments)}}return t}),i("lodash/internal/isIterateeCall",["./isIndex","./isLength","../lang/isObject"],function(e,t,n){function r(r,i,s){if(!n(s))return!1;var o=typeof i;if(o=="number")var u=s.length,a=t(u)&&e(i,u);else a=o=="string"&&i in s;if(a){var f=s[i];return r===r?r===f:f!==f}return!1}return r}),i("lodash/internal/createAssigner",["./bindCallback","./isIterateeCall"],function(e,t){function n(n){return function(){var r=arguments.length,i=arguments[0];if(r<2||i==null)return i;r>3&&t(arguments[1],arguments[2],arguments[3])&&(r=2);if(r>3&&typeof arguments[r-2]=="function")var s=e(arguments[--r-1],arguments[r--],5);else r>2&&typeof arguments[r-1]=="function"&&(s=arguments[--r]);var o=0;while(++o<r){var u=arguments[o];u&&n(i,u,s)}return i}}return n}),i("lodash/object/merge",["../internal/baseMerge","../internal/createAssigner"],function(e,t){var n=t(e);return n}),i("src/load-schema",[],function(){function e(e,t){try{var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){n.status>=200&&n.status<400?t(JSON.parse(n.responseText)):console.error("Couldn't get template file: "+e)},n.onerror=function(){console.error("Couldn't get template file: "+e)},n.send()}catch(r){console.error(r.stack())}}return e}),i("src/load-template",["handlebars"],function(e){function t(t,n){try{var r=new XMLHttpRequest;r.open("GET",t,!0),r.onload=function(){r.status>=200&&r.status<400?n(e.compile(r.responseText)):console.error("Couldn't get template file: "+t)},r.onerror=function(){console.error("Couldn't get template file: "+t)},r.send()}catch(i){console.error(i.stack())}}return t}),i("cite-api",["require","lodash/object/merge","src/load-schema","src/load-template"],function(e){var t=e("lodash/object/merge"),n=function(e){var n={maxDepth:2,templateDir:"./template",containerElement:null};this.options=t(n,e);var r=function(e){var t={data:"Wow this actually works"};this.options.containerElement.innerHTML=e(t)}.bind(this);this.loadTemplate(this.options.templateDir+"/echo.handlebars",r)};return n.prototype.load=function(e){},n.prototype.loadSchema=e("src/load-schema"),n.prototype.loadTemplate=e("src/load-template"),n}),i("handlebars",function(){return Handlebars}),r("cite-api")});